<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Residual Values based on 'rma' Objects</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for residuals.rma {metafor}"><tr><td>residuals.rma {metafor}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Residual Values based on 'rma' Objects</h2>

<h3>Description</h3>

<p>The <code>residuals</code>, <code>rstandard</code>, and <code>rstudent</code> functions compute residuals, corresponding standard errors, and standardized residuals for models fitted with the <code><a href="rma.uni.html">rma.uni</a></code>, <code><a href="rma.mh.html">rma.mh</a></code>, <code><a href="rma.peto.html">rma.peto</a></code>, and <code><a href="rma.mv.html">rma.mv</a></code> functions.
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'rma'
residuals(object, type="response", ...)

## S3 method for class 'rma.uni'
rstandard(model, digits, type="marginal", ...)
## S3 method for class 'rma.mh'
rstandard(model, digits, ...)
## S3 method for class 'rma.peto'
rstandard(model, digits, ...)
## S3 method for class 'rma.mv'
rstandard(model, digits, cluster, ...)

## S3 method for class 'rma.uni'
rstudent(model, digits, progbar=FALSE, ...)
## S3 method for class 'rma.mh'
rstudent(model, digits, progbar=FALSE, ...)
## S3 method for class 'rma.peto'
rstudent(model, digits, progbar=FALSE, ...)
## S3 method for class 'rma.mv'
rstudent(model, digits, progbar=FALSE, cluster,
         reestimate=TRUE, parallel="no", ncpus=1, cl=NULL, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>an object of class <code>"rma"</code> (for <code>residuals</code>).</p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
<p>the type of residuals which should be returned. For <code>residuals</code>, the alternatives are: <code>"response"</code> (default), <code>"rstandard"</code>, <code>"rstudent"</code>, and <code>"pearson"</code>. For <code>rstandard.rma.uni</code>, the alternatives ares: <code>"marginal"</code> (default) and <code>"conditional"</code>. See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr valign="top"><td><code>model</code></td>
<td>
<p>an object of class <code>"rma"</code> (for <code>residuals</code>) or an object of class <code>"rma.uni"</code>, <code>"rma.mh"</code>, <code>"rma.peto"</code>, or <code>"rma.mv"</code> (for <code>rstandard</code> and <code>rstudent</code>).</p>
</td></tr>
<tr valign="top"><td><code>cluster</code></td>
<td>
<p>optional vector specifying a clustering variable to use for computing cluster-level multivariate standardized residuals (only for <code>"rma.mv"</code> objects).</p>
</td></tr>
<tr valign="top"><td><code>reestimate</code></td>
<td>
<p>logical indicating whether variance/correlation components should be re-estimated after deletion of the <i>i</i>th study/cluster when computing externally standardized residuals (the default is <code>TRUE</code>).</p>
</td></tr>
<tr valign="top"><td><code>parallel</code></td>
<td>
<p>character string indicating whether parallel processing should be used (the default is <code>"no"</code>). For parallel processing, set to either <code>"snow"</code> or <code>"multicore"</code>. See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr valign="top"><td><code>ncpus</code></td>
<td>
<p>integer specifying the number of processes to use in the parallel processing.</p>
</td></tr>
<tr valign="top"><td><code>cl</code></td>
<td>
<p>optional snow cluster to use if <code>parallel="snow"</code>. If not supplied, a cluster on the local machine is created for the duration of the call.</p>
</td></tr>
<tr valign="top"><td><code>digits</code></td>
<td>
<p>integer specifying the number of decimal places to which the printed results should be rounded (if unspecified, the default is to take the value from the object).</p>
</td></tr>
<tr valign="top"><td><code>progbar</code></td>
<td>
<p>logical indicating whether a progress bar should be shown (only for <code>rstudent</code>) (the default is <code>FALSE</code>).</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The observed residuals (obtained with <code>residuals</code>) are simply equal to the &lsquo;observed - fitted&rsquo; values. These can be obtained with <code>residuals(object)</code> (using the default <code>type="response"</code>).
</p>
<p>Dividing the observed residuals by the model-implied standard errors of the observed effect sizes or outcomes yields Pearson (or semi-standardized) residuals. These can be obtained with <code>residuals(object, type="pearson")</code>.
</p>
<p>Dividing the observed residuals by their corresponding standard errors yields (internally) standardized residuals. These can be obtained with <code>rstandard</code> or <code>residuals(object, type="rstandard")</code>.
</p>
<p>The <code>rstudent</code> function (or <code>residuals(object, type="rstudent")</code>) calculates externally standardized residuals (also called standardized deleted residuals or (externally) studentized residuals). The externally standardized residual for the <i>i</i>th case is obtained by deleting the <i>i</i>th case from the dataset, fitting the model based on the remaining cases, calculating the predicted value for the <i>i</i>th case based on the fitted model, taking the difference between the observed and the predicted value for the <i>i</i>th case (which yields the deleted residual), and then standardizing the deleted residual based on its standard error.
</p>
<p>If a particular study fits the model, its standardized residual follows (asymptotically) a standard normal distribution. A large standardized residual for a study therefore may suggest that the study does not fit the assumed model (i.e., it may be an outlier).
</p>
<p>For <code>"rma.uni"</code> objects, <code>rstandard.rma.uni</code> also can compute conditional residuals (when <code>type="conditional"</code>), which are the deviations of the observed outcomes from the best linear unbiased predictions (BLUPs) of the study-specific true outcomes (see <code><a href="blup.html">blup.rma.uni</a></code>).
</p>
<p>For <code>"rma.mv"</code> objects, one can specify a clustering variable (via the <code>cluster</code> argument). If specified, <code>rstandard</code> and <code>rstudent</code> also compute cluster-level multivariate (internally or externally) standardized residuals. If all outcomes within a cluster fit the model, then the multivariate standardized residual for the cluster follows (asymptotically) a chi-square distribution with <i>kᵢ</i> degrees of freedom (where <i>kᵢ</i> denotes the number of outcomes within the cluster).
</p>
<p>See also <code><a href="influence.rma.uni.html">influence.rma.uni</a></code> and <code><a href="influence.rma.mv.html">influence.rma.mv</a></code> for other leave-one-out diagnostics that are useful for detecting influential cases in models fitted with the <code><a href="rma.uni.html">rma.uni</a></code> and <code><a href="rma.mv.html">rma.mv</a></code> functions.
</p>


<h3>Value</h3>

<p>Either a vector with the residuals of the requested type (for <code>residuals</code>) or an object of class <code>"list.rma"</code>, which is a list containing the following components:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>resid</code></td>
<td>
<p>observed residuals (for <code>rstandard</code>) or deleted residuals (for <code>rstudent</code>).</p>
</td></tr>
<tr valign="top"><td><code>se</code></td>
<td>
<p>corresponding standard errors.</p>
</td></tr>
<tr valign="top"><td><code>z</code></td>
<td>
<p>standardized residuals (internally standardized for <code>rstandard</code> or externally standardized for <code>rstudent</code>).</p>
</td></tr>
</table>
<p>When a clustering variable is specified for <code>"rma.mv"</code> objects, the returned object is a list with the first element (named <code>obs</code>) as described above and a second element (named <code>cluster</code> of class <code>"list.rma"</code> with:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>X2</code></td>
<td>
<p>cluster-level multivariate standardized residuals.</p>
</td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
<p>number of outcomes within the clusters.</p>
</td></tr>
</table>
<p>The <code>"list.rma"</code> object is formatted and printed with <code><a href="print.list.rma.html">print.list.rma</a></code>.
</p>


<h3>Note</h3>

<p>Right now, the externally standardized residuals (obtained with <code>rstudent</code>) are calculated by refitting the model <i>k</i> times (where <i>k</i> is the number of studies/clusters). Depending on how large <i>k</i> is, it may take a few moments to finish the calculations. For complex models fitted with <code><a href="rma.mv.html">rma.mv</a></code>, this can become computationally expensive.
</p>
<p>On machines with multiple cores, one can usually speed things up by delegating the model fitting to separate worker processes, that is, by setting <code>parallel="snow"</code> or <code>parallel="multicore"</code> and <code>ncpus</code> to some value larger than 1 (only for objects of class <code>"rma.mv"</code>). Parallel processing makes use of the <code><a href="../../parallel/html/parallel.html">parallel</a></code> package, using the <code><a href="../../parallel/html/makePSOCKcluster.html">makePSOCKcluster</a></code> and <code><a href="../../parallel/html/parLapply.html">parLapply</a></code> functions when <code>parallel="snow"</code> or using <code><a href="../../parallel/html/mclapply.html">mclapply</a></code> when <code>parallel="multicore"</code> (the latter only works on Unix/Linux-alikes). With <code>parallel::detectCores()</code>, one can check on the number of available cores on the local machine.
</p>
<p>Alternatively (or in addition to using parallel processing), one can also set <code>reestimate=FALSE</code>, in which case any variance/correlation components in the model are not re-estimated after deleting the <i>i</i>th study/cluster from the dataset. Doing so only yields an approximation to the externally standardized residuals (and the cluster-level multivariate standardized residuals) that ignores the influence of the <i>i</i>th study/cluster on the variance/correlation components, but is considerably faster (and often yields similar results).
</p>
<p>It may not be possible to fit the model after deletion of the <i>i</i>th study/cluster from the dataset. This will result in <code>NA</code> values for that study/cluster when calling <code>rstudent</code>.
</p>
<p>Also, for <code>"rma.mv"</code> objects with a clustering variable specified, it may not be possible to compute the cluster-level multivariate standardized residual for a particular cluster (if the var-cov matrix of the residuals within a cluster is not of full rank). This will result in <code>NA</code> for that cluster.
</p>
<p>For objects of class <code>"rma.mh"</code> and <code>"rma.peto"</code>, <code>rstandard</code> actually computes Pearson (or semi-standardized) residuals.
</p>


<h3>Author(s)</h3>

<p>Wolfgang Viechtbauer <a href="mailto:wvb@metafor-project.org">wvb@metafor-project.org</a> <a href="http://www.metafor-project.org/">http://www.metafor-project.org/</a>
</p>


<h3>References</h3>

<p>Hedges, L. V., &amp; Olkin, I. (1985). <em>Statistical methods for meta-analysis</em>. San Diego, CA: Academic Press.
</p>
<p>Viechtbauer, W. (2010). Conducting meta-analyses in R with the metafor package. <em>Journal of Statistical Software</em>, <b>36</b>(3), 1&ndash;48. <a href="https://www.jstatsoft.org/v036/i03">https://www.jstatsoft.org/v036/i03</a>.
</p>
<p>Viechtbauer, W., &amp; Cheung, M. W.-L. (2010). Outlier and influence diagnostics for meta-analysis. <em>Research Synthesis Methods</em>, <b>1</b>, 112&ndash;125.
</p>


<h3>See Also</h3>

<p><code><a href="rma.uni.html">rma.uni</a></code>, <code><a href="rma.mh.html">rma.mh</a></code>, <code><a href="rma.peto.html">rma.peto</a></code>, <code><a href="rma.glmm.html">rma.glmm</a></code>, <code><a href="rma.mv.html">rma.mv</a></code>, <code><a href="influence.rma.uni.html">influence.rma.uni</a></code>, <code><a href="influence.rma.mv.html">influence.rma.mv</a></code>
</p>


<h3>Examples</h3>

<pre>
### meta-analysis of the log risk ratios using a random-effects model
res &lt;- rma(measure="RR", ai=tpos, bi=tneg, ci=cpos, di=cneg, data=dat.bcg)
rstudent(res)

### mixed-effects model with absolute latitude as a moderator
res &lt;- rma(measure="RR", ai=tpos, bi=tneg, ci=cpos, di=cneg, mods = ~ ablat,
           data=dat.bcg)
rstudent(res)
</pre>

<hr /><div style="text-align: center;">[Package <em>metafor</em> version 2.4-0 <a href="00Index.html">Index</a>]</div>
</body></html>
